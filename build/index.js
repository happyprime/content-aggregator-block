!function(){var e={184:function(e,t){var o;!function(){"use strict";var a={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var l=typeof o;if("string"===l||"number"===l)e.push(o);else if(Array.isArray(o)){if(o.length){var s=n.apply(null,o);s&&e.push(s)}}else if("object"===l)if(o.toString===Object.prototype.toString)for(var r in o)a.call(o,r)&&o[r]&&e.push(r);else e.push(o.toString())}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(o=function(){return n}.apply(t,[]))||(e.exports=o)}()}},t={};function o(a){var n=t[a];if(void 0!==n)return n.exports;var l=t[a]={exports:{}};return e[a](l,l.exports,o),l.exports}o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=window.wp.element,t=window.wp.blocks,a=window.wp.primitives,n=o(184),l=o.n(n),s=window.wp.apiFetch,r=o.n(s),c=window.wp.blockEditor,i=window.wp.components,m=window.wp.data,p=window.wp.date,u=window.wp.hooks,d=window.wp.i18n,g=(0,e.createElement)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)(a.Path,{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM15.5303 8.46967C15.8232 8.76256 15.8232 9.23744 15.5303 9.53033L13.0607 12L15.5303 14.4697C15.8232 14.7626 15.8232 15.2374 15.5303 15.5303C15.2374 15.8232 14.7626 15.8232 14.4697 15.5303L12 13.0607L9.53033 15.5303C9.23744 15.8232 8.76256 15.8232 8.46967 15.5303C8.17678 15.2374 8.17678 14.7626 8.46967 14.4697L10.9393 12L8.46967 9.53033C8.17678 9.23744 8.17678 8.76256 8.46967 8.46967C8.76256 8.17678 9.23744 8.17678 9.53033 8.46967L12 10.9393L14.4697 8.46967C14.7626 8.17678 15.2374 8.17678 15.5303 8.46967Z"})),h=(0,e.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,e.createElement)(a.Path,{d:"M10 1c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9zm0 16c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7zm1-11H9v3H6v2h3v3h2v-3h3V9h-3V6zM10 1c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9zm0 16c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7zm1-11H9v3H6v2h3v3h2v-3h3V9h-3V6z"})),y=(0,e.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(a.Path,{d:"m21.5 9.1-6.6-6.6-4.2 5.6c-1.2-.1-2.4.1-3.6.7-.1 0-.1.1-.2.1-.5.3-.9.6-1.2.9l3.7 3.7-5.7 5.7v1.1h1.1l5.7-5.7 3.7 3.7c.4-.4.7-.8.9-1.2.1-.1.1-.2.2-.3.6-1.1.8-2.4.6-3.6l5.6-4.1zm-7.3 3.5.1.9c.1.9 0 1.8-.4 2.6l-6-6c.8-.4 1.7-.5 2.6-.4l.9.1L15 4.9 19.1 9l-4.9 3.6z"})),_=(0,e.createElement)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)(a.Path,{d:"M4 4v1.5h16V4H4zm8 8.5h8V11h-8v1.5zM4 20h16v-1.5H4V20zm4-8c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2z"})),v=(0,e.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(a.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7.8 16.5H5c-.3 0-.5-.2-.5-.5v-6.2h6.8v6.7zm0-8.3H4.5V5c0-.3.2-.5.5-.5h6.2v6.7zm8.3 7.8c0 .3-.2.5-.5.5h-6.2v-6.8h6.8V19zm0-7.8h-6.8V4.5H19c.3 0 .5.2.5.5v6.2z",fillRule:"evenodd",clipRule:"evenodd"})),b=window.wp.url,x=window.wp.htmlEntities;function w(t){const{onChange:o,selectedTerms:a,taxonomy:n}=t,[l,s]=(0,e.useState)([]),c=(0,e.useRef)(),m=n.split(",")[1];return(0,e.useEffect)((()=>(c.current=!0,r()({path:(0,b.addQueryArgs)(`/wp/v2/${m}`,{per_page:-1})}).then((e=>{if(c.current){const t=e.map((e=>({label:(0,x.decodeEntities)(e.name),value:e.id})));s(t)}})).catch((()=>{c.current&&s([])})),()=>{c.current=!1})),[n]),(0,e.createElement)(i.SelectControl,{className:"happyprime-block-cab_taxonomy-term-select",help:(0,d.__)("Ctrl/Cmd + click to select multiple terms"),label:(0,d.__)("Term(s)"),multiple:!0,onChange:o,options:l,value:a})}const E={per_page:-1},C={slug:"",terms:[],operator:"IN"};var f={from:[{type:"block",blocks:["core/latest-posts"],transform:e=>(0,t.createBlock)("happyprime/content-aggregator",{itemCount:e.postsToShow,order:e.order,orderBy:e.orderBy,displayPostDate:e.displayPostDate,postLayout:e.postLayout,columns:e.columns,displayPostContent:e.displayPostContent,postContent:e.displayPostContentRadio,excerptLength:e.excerptLength,displayImage:e.displayFeaturedImage,imageSize:e.featuredImageSizeSlug,stickyPosts:!1,addLinkToFeaturedImage:e.addLinkToFeaturedImage})},{type:"block",blocks:["happyprime/latest-custom-posts"],transform:e=>{const o=e.taxonomies&&0<e.taxonomies.length?e.taxonomies:e.customTaxonomy?"string"!=typeof e.customTaxonomy?e.customTaxonomy:[{slug:e.customTaxonomy,terms:[`${e.termID}`]}]:[];return(0,t.createBlock)("happyprime/content-aggregator",{customPostType:e.customPostType,taxonomies:o,taxRelation:e.taxRelation,itemCount:e.itemCount,order:e.order,orderBy:e.orderBy,displayPostDate:e.displayPostDate,postLayout:e.postLayout,columns:e.columns,displayPostContent:e.displayPostContent,postContent:e.postContent,excerptLength:e.excerptLength,displayImage:e.displayImage,imageSize:e.imageSize,stickyPosts:e.stickyPosts})}}]};(0,t.registerBlockType)("happyprime/content-aggregator",{icon:(0,e.createElement)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)(a.Path,{d:"M11 7h6v2h-6zM11 11h6v2h-6zM11 15h6v2h-6zM7 7h2v2H7zM7 11h2v2H7zM7 15h2v2H7z"}),(0,e.createElement)(a.Path,{d:"M20.1 3H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9zM19 19H5V5h14v14z"})),transforms:f,edit:function(t){const{attributes:o,setAttributes:a}=t,{addLinkToFeaturedImage:n,columns:s,customPostType:x,displayImage:f,displayPostContent:k,displayPostDate:P,excerptLength:T,imageSize:S,itemCount:z,order:L,orderBy:N,postContent:B,postLayout:R,stickyPosts:A,taxRelation:I,taxonomies:M}=o,V=x.split(",")[0],{postTypeOptions:D,taxonomyOptions:H,imageSizeOptions:O}=(0,m.useSelect)((e=>{const{getPostTypes:t,getTaxonomies:o}=e("core"),a=t(E),n=o(E),l=e("core/block-editor").getSettings().imageSizes,s=(0,u.applyFilters)("contentAggregatorBlock.ExcludePostTypes",["attachment"]),r=[],c=[],i=[];return a&&a.forEach((e=>{e.viewable&&e.rest_base&&!s.includes(e.slug)&&(r.push({label:e.labels.singular_name,value:e.slug}),V===e.slug&&e.taxonomies.length&&n&&(c.push({label:(0,d.__)("None"),value:""}),n.forEach((t=>{t.visibility.public&&e.taxonomies.includes(t.slug)&&c.push({label:t.name,value:t.slug+","+t.rest_base})}))))})),l&&l.forEach((e=>{i.push({value:e.slug,label:e.name})})),{postTypeOptions:r,taxonomyOptions:c,imageSizeOptions:i}}),[V]),[F,j]=(0,e.useState)(""),G=(0,e.useRef)();(0,e.useEffect)((()=>{G.current=!0;const e={post_type:V,per_page:z,order:L,orderby:N};if(cabStickyPostSupport.includes(V)&&A&&(e.sticky_posts=!0),M&&(e.taxonomies=M,I&&(e.tax_relation=I)),r()({path:(0,b.addQueryArgs)("/content-aggregator-block/v1/posts/",e)}).then((e=>{G.current&&j(e)})).catch((()=>{G.current&&j([])})),G.currrent&&(o.customTaxonomy||o.termID)){const e=[{slug:o.customTaxonomy,terms:[`${o.termID}`]}];a({taxonomies:e,customTaxonomy:void 0,termID:void 0})}return()=>{G.current=!1}}),[z,L,N,V,A,M,I]);const $=Array.isArray(F)&&F.length,W=(0,c.useBlockProps)({className:l()({"wp-block-latest-posts":!0,"happyprime-block-cab_error":!$,"cab-has-post-thumbnail":f,"cab-has-post-date":P,"cab-has-post-content":k&&"full_post"===B,"cab-has-post-excerpt":k&&"excerpt"===B,"is-grid":"grid"===R,[`columns-${s}`]:"grid"===R})}),Z=(e,t,o)=>{let a;if(void 0!==M&&M.length&&(a=Object.values({...M,[e]:{...M[e],[t]:o}})),"slug"===t&&(void 0!==M&&M.length?o!==M[e].slug&&(a=Object.values({...a,[e]:{...a[e],terms:[],operator:void 0}})):a=[{slug:o,terms:[],operator:"IN"}]),"terms"===t){const t=!M[e].operator&&1<o.length?"IN":1<o.length?M[e].operator:void 0;a=Object.values({...a,[e]:{...a[e],operator:t}})}return a},q=(t,o)=>(0,e.createElement)("div",{className:"happyprime-block-cab_taxonomy-setting-wrapper"},0<o&&(0,e.createElement)(i.Button,{className:"happyprime-block-cab_taxonomy-remove-setting",icon:g,label:(0,d.__)("Remove taxonomy setting"),onClick:()=>{M.splice(o,1),a({taxonomies:[...M]}),1===M.length&&a({taxRelation:void 0})}}),(0,e.createElement)("div",{className:"happyprime-block-cab_taxonomy-setting"},(0,e.createElement)(i.SelectControl,{label:(0,d.__)("Taxonomy"),value:t.slug?t.slug:"",options:H,onChange:e=>{""===e?1===M.length?a({taxonomies:[]}):(M.splice(o,1),a({taxonomies:[...M]})):a({taxonomies:Z(o,"slug",e)})}}),""!==t.slug&&(0,e.createElement)(w,{onChange:e=>a({taxonomies:Z(o,"terms",e)}),selectedTerms:t.terms,taxonomy:t.slug}),t.terms&&1<t.terms.length&&(0,e.createElement)(i.RadioControl,{label:(0,d.__)("Show posts:"),selected:t.operator,options:[{label:(0,d.__)("With any selected terms"),value:"IN"},{label:(0,d.__)("With all selected terms"),value:"AND"},{label:(0,d.__)("Without the selected terms"),value:"NOT IN"}],onChange:e=>a({taxonomies:Z(o,"operator",e)})}))),Q=(0,e.createElement)(c.InspectorControls,null,(0,e.createElement)(i.PanelBody,{title:(0,d.__)("Settings"),className:"happyprime-block-cab"},"grid"===R&&(0,e.createElement)(i.RangeControl,{label:(0,d.__)("Columns"),value:s,onChange:e=>a({columns:e}),min:2,max:$?Math.min(6,F.length):6,required:!0}),(0,e.createElement)(i.SelectControl,{help:(0,d.__)('WordPress contains different types of content which are divided into collections called "Post Types". Default types include blog posts and pages, though plugins may remove these or add others.'),label:(0,d.__)("Post Type"),value:x,options:D,onChange:e=>{a({customPostType:e,taxonomies:[]})}}),(0,e.createElement)(i.RangeControl,{label:(0,d.__)("Number of Items"),value:z,onChange:e=>{a({itemCount:Number(e)})},min:1,max:100}),(0,e.createElement)(i.SelectControl,{key:"query-controls-order-select",label:(0,d.__)("Order By"),value:`${N}/${L}`,options:[{label:(0,d.__)("Newest to Oldest"),value:"date/desc"},{label:(0,d.__)("Oldest to Newest"),value:"date/asc"},{label:(0,d.__)("A → Z"),value:"title/asc"},{label:(0,d.__)("Z → A"),value:"title/desc"},{label:(0,d.__)("Random"),value:"rand/desc"}],onChange:e=>{const[t,o]=e.split("/"),n={};o!==L&&(n.order=o),t!==N&&(n.orderBy=t),(n.order||n.orderBy)&&a(n)}}),cabStickyPostSupport.includes(x.split(",")[0])&&"date"===N&&(0,e.createElement)(i.ToggleControl,{label:(0,d.__)("Show sticky posts at the start of the set"),checked:A,onChange:e=>{a({stickyPosts:e})}})),(0,e.createElement)(i.PanelBody,{title:(0,d.__)("Filters"),className:"happyprime-block-cab"},(0,e.createElement)("div",{className:"happyprime-block-cab_taxonomy-settings"},(0,e.createElement)("p",null,(0,d.__)("Taxonomies")),M&&0<M.length?M.map(((e,t)=>q(e,t))):q(C,0),M&&0<M.length&&M[0].terms&&0<M[0].terms.length&&(0,e.createElement)(i.Button,{className:"happyprime-block-cab_taxonomy-add-setting",icon:h,onClick:()=>{a({taxonomies:M.concat(C)}),I||a({taxRelation:"AND"})},text:(0,d.__)("Add more taxonomy settings")}),M&&1<M.length&&(0,e.createElement)("div",{className:"happyprime-block-cab_taxonomy-relation"},(0,e.createElement)("p",null,(0,d.__)("Taxonomy Settings Relationship")),(0,e.createElement)(i.RadioControl,{label:(0,d.__)("Show posts that match:"),selected:I,options:[{label:(0,d.__)('All settings ("AND")'),value:"AND"},{label:(0,d.__)('Any settings ("OR")'),value:"OR"}],onChange:e=>a({taxRelation:e})})))),(0,e.createElement)(i.PanelBody,{title:(0,d.__)("Post Template"),className:"happyprime-block-cab"},(0,e.createElement)(i.ToggleControl,{label:(0,d.__)("Display post date"),checked:P,onChange:e=>a({displayPostDate:e})}),(0,e.createElement)(i.ToggleControl,{label:(0,d.__)("Display post content"),checked:k,onChange:e=>a({displayPostContent:e})}),k&&(0,e.createElement)(i.RadioControl,{label:(0,d.__)("Show"),selected:B,options:[{label:(0,d.__)("Excerpt"),value:"excerpt"},{label:(0,d.__)("Full Post"),value:"full_post"}],onChange:e=>a({postContent:e})}),k&&"excerpt"===B&&(0,e.createElement)(i.RangeControl,{label:(0,d.__)("Max number of words in excerpt"),value:T,onChange:e=>a({excerptLength:e}),min:10,max:100}),(0,e.createElement)(i.ToggleControl,{label:(0,d.__)("Display featured image"),checked:f,onChange:e=>a({displayImage:e})}),f&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(i.SelectControl,{label:(0,d.__)("Image size"),onChange:e=>a({imageSize:e}),options:O,value:S}),(0,e.createElement)(i.ToggleControl,{label:(0,d.__)("Add link to featured image"),checked:n,onChange:e=>a({addLinkToFeaturedImage:e})}))));if(!$)return(0,e.createElement)("div",W,Q,(0,e.createElement)(i.Placeholder,{icon:y,label:(0,d.__)("Content Aggregator")},Array.isArray(F)?(0,d.__)("No current items."):(0,e.createElement)(i.Spinner,null)));const U=F.length>z?F.slice(0,z):F;return(0,e.createElement)(e.Fragment,null,Q,(0,e.createElement)(c.BlockControls,null,(0,e.createElement)(i.ToolbarGroup,{controls:[{icon:_,title:(0,d.__)("List View"),onClick:()=>a({postLayout:"list"}),isActive:"list"===R},{icon:v,title:(0,d.__)("Grid View"),onClick:()=>a({postLayout:"grid"}),isActive:"grid"===R}]})),(0,e.createElement)("ul",W,U.map((t=>(t=>{const a=t.title.trim(),l=document.createElement("div");l.innerHTML=t.excerpt;const s=l.textContent||l.innerText||"",r=(0,e.createElement)("li",null,(0,e.createElement)(i.Disabled,null,(0,e.createElement)("a",{href:t.link,rel:"noreferrer noopener"},a?(0,e.createElement)(e.RawHTML,null,a):(0,d.__)("(Untitled)"))),P&&t.date_gmt&&(0,e.createElement)("time",{dateTime:(0,p.format)("c",t.date_gmt),className:"wp-block-latest-posts__post-date"},(0,p.dateI18n)((0,p.__experimentalGetSettings)().formats.date,t.date_gmt)),f&&t.image[S]&&(0,e.createElement)("figure",{className:"wp-block-latest-posts__post-thumbnail"},n?(0,e.createElement)(i.Disabled,null,(0,e.createElement)("a",{href:t.link,rel:"noreferrer noopener"},(0,e.createElement)("img",{src:t.image[S],alt:""}))):(0,e.createElement)("img",{src:t.image[S],alt:""})),k&&"excerpt"===B&&(0,e.createElement)("div",{className:"wp-block-latest-posts__post-excerpt"},(0,e.createElement)(e.RawHTML,{key:"html"},T<s.trim().split(" ").length?s.trim().split(" ",T).join(" ")+"…":s.trim().split(" ",T).join(" "))),k&&"full_post"===B&&(0,e.createElement)("div",{className:"wp-block-latest-posts__post-full-content"},(0,e.createElement)(e.RawHTML,{key:"html"},t.content.trim())));return(0,u.applyFilters)("contentAggregatorBlock.itemHTML",r,t,o)})(t)))))}})}()}();